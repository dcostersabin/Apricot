<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/style.css">
    {#    fonts#}
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Domine:wght@700&family=Nunito:wght@400;800&display=swap"
          rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Work+Sans:wght@700&display=swap" rel="stylesheet">
    {#    icons#}
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.css">


    <title>Dashboard</title>
</head>
<body>
<!-- As a heading -->
<nav class="navbar navbar-light navbar-fixed-top" style="margin: 0">
    <div class="container-fluid">
        <img class="navbar-brand" height="60" width="200" src="/static/images/logo-alt.svg"
             style="margin: 0;padding: 0 ;cursor: pointer"
             onclick="window.location.href='http://localhost:8001/dashboard'">
        <span style="font-family: 'Work Sans', sans-serif;"
              class="text-muted text-capitalize">{{ user.username }}
            {% if not user.is_superuser %}
                <img src="{{ user_image }}" height="30"
                     width="30"
                     class="m-2 rounded-circle border border-secondary">

            {% endif %}
            {% if  user.is_superuser %}
                <img src="/static/images/admin.png" height="30"
                     width="30"
                     class="m-2 rounded-circle border border-secondary">

            {% endif %}

            <i class="bi bi-box-arrow-left" style="cursor: pointer"
               onclick="window.location.href='http://localhost:8001/logout'"></i>
        </span>

    </div>
</nav>

{% if not user.is_superuser %}
    <div class="custom">
        <div class="column p-2" style="color: #263671">
            <div class="row">
                <div class="col text-center">
                    <h2 style="font-family: 'Nunito', sans-serif;">Assigned Question</h2>
                </div>
            </div>
            {% if not user.verified %}
                <div class="row">
                    <div class="col text-center">
                        <div class="alert alert-danger" role="alert">
                            Your Email Is Not Verified. Please Verify Your Email Before Question Is Assigned.
                        </div>
                    </div>
                </div>
            {% endif %}
            {% if user.verified %}
                <div class="alert alert-info">
                    {{ question|capfirst }}
                </div>
                <div class="col">
                    <div class="alert alert-primary">
                        Note: Create A Class Called Testing Containing A Function Named Setup Which Takes params As A
                        Function Parameter. Treat params As A String Input And Convert Them As Per Your Requirement.
                        And make sure you write your code in test.py file
                        <br>
                        <br>
                        Your Code Should Look Like:

                    </div>
                    <div class="alert alert-secondary">
                        <div class="row">
                            <div class="col text-right">
                                ----For Python Implementation ----
                                <br>
                                <br>
                                class Testing:
                                <br>
                                <br>
                                &nbsp;&nbsp;&nbsp; def setup(params):
                                <br>
                                <br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ## Your Code Goes Here ##
                            </div>
                            <div class="col text-right">
                                ----For Ruby Implementation ----
                                <br>
                                <br>
                                module Testing
                                <br>
                                &nbsp;&nbsp;&nbsp;def Testing.setup(params)
                                <br>
                                <br>
                                &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; ## Your Code Goes Here ##
                                <br>
                                &nbsp;&nbsp;&nbsp;end
                                <br>
                                end

                            </div>
                        </div>
                    </div>
                    <div class="alert alert-warning">
                        Note: You Can Submit Only Once So Choose Your Submission Wisely
                    </div>
                    <div class="row">
                        <h4 style="font-family: 'Nunito', sans-serif;" class="text-muted">Your Submission Log</h4>
                        <div class="col">
                            <table class="table">
                                <thead>
                                <tr>
                                    <th scope="col">submission id</th>
                                    <th scope="col">Language Type</th>
                                    <th scope="col">Checked Status</th>
                                    <th scope="col">Repo Url</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <th scope="row">{{ submission.submission_id }}</th>
                                    <td>{% if submission.language_type == 1 %}
                                        Python
                                    {% elif submission.language_type == 2 %}
                                        Ruby
                                    {% endif %}
                                    </td>
                                    <td>{% if submission.checked_status %}
                                        Checked
                                    {% else %}
                                        Not Checked
                                    {% endif %}
                                    </td>
                                    <td>
                                        {% if submission.repo_url == 'None' %}
                                            Not Submitted
                                        {% else %}
                                            {{ submission.repo_url }}
                                        {% endif %}
                                    </td>
                                </tr>

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            {% endif %}

        </div>
        <div class="column p-5">


            <div class="row">
                <div class="col">
                    {% if messages %}
                        {% for message in messages %}
                            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                        {% endfor %}
                    {% endif %}
                </div>
            </div>
            <h4 style="font-family: 'Nunito', sans-serif;">Lets select your repo for review</h4>
            <small class="text-muted">Search</small>

            <div class="active-cyan-3 active-cyan-4 mb-4">
                <input class="col-auto" type="text" placeholder="Enter Repository Name "
                       onkeydown="search()" id="search-title">
                <span class="col-auto"><button class="btn btn-outline-danger"
                                               onclick="repohide()">Clear</button></span>
                <span class="col-auto"><button class="btn btn-outline-success"
                                               onclick="window.location.href='refresh_repo'">Refresh Repo</button></span>
            </div>
            {% for foo in repo %}
                <div class="repo">
                    <div class="alert alert-success">
                        <div class="row p-2">
                            <div class="col">
                                <div class="row"
                                     style="font-family: 'Nunito', sans-serif; cursor: pointer">
                                    <h5 onclick="window.location.href='{{ foo.html_url }}'">{{ foo.repo_name }}</h5>
                                </div>
                                <div class="row text-muted"><i class="bi bi-journals">&nbsp;<small>GithHub
                                    -
                                    {% if foo.private %}
                                        Private
                                    {% else %}
                                        Public
                                    {% endif %}
                                </small>- Size:{{ foo.size }} - Language: {{ foo.language }}</i></div>

                            </div>
                            <div class="col">
                                <div class="row">
                                    <div class="col text-center">
                                        <button class="btn btn-outline-primary fw-bolder"
                                                style="border-color: #263671;color: #263671"
                                                onclick="window.location.href='http://localhost:8001/submit/{{ submission.submission_id }}/{{ foo.repo_full_name }}'">
                                            Submit
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <hr>
                        </div>
                    </div>
                </div>
            {% endfor %}

            <h5 class="text-muted mt-3" style="font-family: 'Nunito', sans-serif;">Your Repository</h5>
            {% for foo in repo %}
                <div class="row p-2">
                    <div class="col">
                        <div class="row" style="font-family: 'Nunito', sans-serif; cursor: pointer"><h5
                                onclick="window.location.href='{{ foo.html_url }}'">{{ foo.repo_name }}</h5>
                        </div>
                        <div class="row text-muted"><i class="bi bi-journals">&nbsp;<small>GithHub -
                            {% if foo.private %}
                                Private
                            {% else %}
                                Public
                            {% endif %}
                        </small>- Size:{{ foo.size }} - Language: {{ foo.language }}</i></div>

                    </div>
                    <div class="col">
                        <div class="row">
                            <div class="col text-center">
                                <button class="btn btn-outline-primary fw-bolder"
                                        style="border-color: #263671;color: #263671"
                                        onclick="window.location.href='http://localhost:8001/submit/{{ submission.submission_id }}/{{ foo.repo_full_name }}'">
                                    Submit
                                </button>
                            </div>
                        </div>
                    </div>
                    <hr>
                </div>
            {% endfor %}


        </div>
    </div>
{% endif %}
{% if user.is_superuser %}
    <div class="container-fluid">
        <div class="row">
            <div class="col">
                {% if messages %}
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
        <div class="row">
            <div class="col">
                <h2 style="font-family: 'Nunito', sans-serif;" class="text-muted">Recent Applicants</h2>
            </div>
            <div class="col text-center">
                <button class="btn btn-outline-primary btn-sm" data-bs-toggle="modal" data-bs-target="#exampleModal">Add
                    Question
                </button>
            </div>
        </div>
        <div class="row" style="font-family: 'Nunito', sans-serif;">
            <div class="col">
                <table class="table">
                    <thead>
                    <tr>
                        <th scope="col">Submission #</th>
                        <th scope="col">First Name</th>
                        <th scope="col">Last Name</th>
                        <th scope="col">Username</th>
                        <th scope="col">Email</th>
                        <th scope="col">Repo Url</th>
                        <th scope="col">Checked Status</th>
                        <th scope="col">Language Type</th>
                        <th scope="col">Question #</th>
                        <th scope="col">Benchmark</th>
                        <th scope="col">Benchmark Details</th>

                    </tr>
                    </thead>
                    <tbody>
                    {% for foo in sub %}
                        <tr>
                            <th scope="row">{{ foo.submission_id }}</th>
                            <td>{{ foo.user_id.first_name }}</td>
                            <td>{{ foo.user_id.last_name }}</td>
                            <td>{{ foo.user_id.username }}</td>
                            <td>{{ foo.user_id.email }}</td>
                            <td>{{ foo.repo_url }}</td>
                            <td>{{ foo.checked_status }}</td>
                            <td>{% if foo.language_type == 1 %}
                                Python
                            {% else %}
                                Ruby
                            {% endif %} </td>
                            <td>{{ foo.question_id }}</td>
                            <td>
                                {% if foo.repo_url == 'None' or foo.checked_status %}
                                    <button class="btn btn-danger disabled">Start</button>
                                {% else %}
                                    <button class="btn btn-success"
                                            onclick="window.location.href='http://localhost:8001/benchmark/{{ foo.submission_id }}'">
                                        Start
                                    </button>

                                {% endif %}
                            </td>
                            <td>{% if foo.checked_status %}
                                <button class="btn btn-outline-info"
                                        onclick="window.location.href='http://localhost:8001/view_score/{{ foo.submission_id }}'">
                                    View Score
                                </button>
                            {% else %}
                                <button class="btn btn-outline-danger disabled ">View Score</button>
                            {% endif %}</td>
                        </tr>
                    {% endfor %}


                    </tbody>
                </table>
            </div>

        </div>
    </div>
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Add Question</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <form action="/add_question" method="post">
                    <div class="modal-body">
                        <div class="row">
                            <div class="col">
                                <div class="input-group m-2">
                                    <span class="input-group-text ">Details</span>
                                    <textarea class="form-control" aria-label="With textarea" name="details"></textarea>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col">
                                <div class="input-group m-2">
                                    <span class="input-group-text p-3">Inputs</span>
                                    <textarea class="form-control" aria-label="With textarea" name="input"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col">
                                <div class="input-group m-2">
                                    <span class="input-group-text p-3">Output</span>
                                    <textarea class="form-control" aria-label="With textarea" name="output"></textarea>
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Save</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="container-fluid">
    <div class="row">
        <div class="col text-center text-info">
            <h1>For Demo Purpose Only</h1>
        </div>
    </div>
    <div class="row">
        <div class="col text-center">
            <button class="btn btn-outline-danger" onclick="window.location.href='http://localhost:8001/reset'">Reset Last Submission</button>
            <button class="btn btn-outline-success" onclick="window.location.href='http://localhost:8001/assign'">Assign Last Question </button>
        </div>
    </div>
    </div>
{% endif %}

</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
        crossorigin="anonymous"></script>
<script src="/static/js/jQuery.js"></script>
<script src="/static/js/script.js">

</script>
</html>